<Window x:Class="Kraken.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:Kraken"
        Title="Kraken" Height="600" Width="1000">
    <Window.Resources>
        <local:SingleItemToEnumerableConverter x:Key="SingleItemConverter" />
    </Window.Resources>
    <DockPanel>
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="5">
            <TextBlock Text="{Binding SystemInfo}" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <Button Content="Refresh" Command="{Binding RefreshCommand}" Margin="0,0,5,0"/>
            <Button Content="Export JSON" Command="{Binding SaveJsonCommand}"/>
        </StackPanel>
        <TabControl>
            <TabItem Header="Windows">
                <DataGrid ItemsSource="{Binding WindowsLicenseList}" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ProductName" Binding="{Binding ProductName}" />
                        <DataGridTextColumn Header="Description" Binding="{Binding Description}" />
                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" />
                        <DataGridTextColumn Header="GraceMinutes" Binding="{Binding GraceMinutes}" />
                        <DataGridTextColumn Header="Expiration" Binding="{Binding Expiration}" />
                        <DataGridTextColumn Header="PartialProductKey" Binding="{Binding PartialProductKey}" />
                        <DataGridTextColumn Header="Channel" Binding="{Binding Channel}" />
                        <DataGridTextColumn Header="EvaluationEndDate" Binding="{Binding EvaluationEndDate}" />
                        <DataGridTextColumn Header="LastActivationTime" Binding="{Binding LastActivationTime}" />
                        <DataGridTextColumn Header="LastActivationHResult" Binding="{Binding LastActivationHResult}" />
                        <DataGridTextColumn Header="KernelTimeBomb" Binding="{Binding KernelTimeBomb}" />
                        <DataGridTextColumn Header="SystemTimeBomb" Binding="{Binding SystemTimeBomb}" />
                        <DataGridTextColumn Header="TrustedTime" Binding="{Binding TrustedTime}" />
                        <DataGridTextColumn Header="RearmCount" Binding="{Binding RearmCount}" />
                        <DataGridCheckBoxColumn Header="IsGenuine" Binding="{Binding IsWindowsGenuineLocal}" IsThreeState="True" />
                        <DataGridTextColumn Header="LicenseKeyFiles" Binding="{Binding LicenseKeyFiles}" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="Office">
                <DataGrid ItemsSource="{Binding OfficeLicenses}" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="SLID" Binding="{Binding SLID}" />
                        <DataGridTextColumn Header="ProductName" Binding="{Binding ProductName}" />
                        <DataGridTextColumn Header="Description" Binding="{Binding Description}" />
                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" />
                        <DataGridTextColumn Header="GraceMinutes" Binding="{Binding GraceMinutes}" />
                        <DataGridTextColumn Header="Expiration" Binding="{Binding Expiration}" />
                        <DataGridTextColumn Header="PartialProductKey" Binding="{Binding PartialProductKey}" />
                        <DataGridTextColumn Header="Channel" Binding="{Binding Channel}" />
                        <DataGridTextColumn Header="OfflineInstallationId" Binding="{Binding OfflineInstallationId}" />
                        <DataGridTextColumn Header="RearmCount" Binding="{Binding RearmCount}" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="KMS Server">
                <DataGrid ItemsSource="{Binding KmsServerList}" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" />
                        <DataGridTextColumn Header="Port" Binding="{Binding Port}" />
                        <DataGridTextColumn Header="IPAddress" Binding="{Binding IPAddress}" />
                        <DataGridTextColumn Header="CurrentClients" Binding="{Binding CurrentClients}" />
                        <DataGridTextColumn Header="TotalRequests" Binding="{Binding TotalRequests}" />
                        <DataGridTextColumn Header="FailedRequests" Binding="{Binding FailedRequests}" />
                        <DataGridTextColumn Header="ServiceState" Binding="{Binding ServiceState}" />
                        <DataGridTextColumn Header="ServiceStatus" Binding="{Binding ServiceStatus}" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="KMS Client">
                <DataGrid ItemsSource="{Binding KmsClientList}" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ClientPid" Binding="{Binding ClientPid}" />
                        <DataGridTextColumn Header="ServerName" Binding="{Binding ServerName}" />
                        <DataGridTextColumn Header="ServerPort" Binding="{Binding ServerPort}" />
                        <DataGridTextColumn Header="DiscoveredName" Binding="{Binding DiscoveredName}" />
                        <DataGridTextColumn Header="DiscoveredPort" Binding="{Binding DiscoveredPort}" />
                        <DataGridTextColumn Header="DiscoveredIP" Binding="{Binding DiscoveredIP}" />
                        <DataGridTextColumn Header="RenewalInterval" Binding="{Binding RenewalInterval}" />
                        <DataGridTextColumn Header="ActivationId" Binding="{Binding ActivationId}" />
                        <DataGridTextColumn Header="LastActivationTime" Binding="{Binding LastActivationTime}" />
                        <DataGridTextColumn Header="RearmCount" Binding="{Binding RearmCount}" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="Subscription">
                <DataGrid ItemsSource="{Binding Summary.Subscription, Converter={StaticResource SingleItemConverter}}" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding Enabled}" />
                        <DataGridTextColumn Header="Sku" Binding="{Binding Sku}" />
                        <DataGridTextColumn Header="State" Binding="{Binding State}" />
                        <DataGridTextColumn Header="LicenseExpiration" Binding="{Binding LicenseExpiration}" />
                        <DataGridTextColumn Header="SubscriptionType" Binding="{Binding SubscriptionType}" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="vNext">
                <DataGrid ItemsSource="{Binding Summary.VNext, Converter={StaticResource SingleItemConverter}}" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridCheckBoxColumn Header="SharedComputerLicensing" Binding="{Binding SharedComputerLicensing}" />
                        <DataGridTextColumn Header="ModePerProductReleaseId" Binding="{Binding ModePerProductReleaseId}" />
                        <DataGridTextColumn Header="Licenses" Binding="{Binding Licenses}" />
                        <DataGridTextColumn Header="LicenseKeyFiles" Binding="{Binding LicenseKeyFiles}" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="AD Activation">
                <DataGrid ItemsSource="{Binding Summary.AdActivation, Converter={StaticResource SingleItemConverter}}" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ObjectName" Binding="{Binding ObjectName}" />
                        <DataGridTextColumn Header="ObjectDN" Binding="{Binding ObjectDN}" />
                        <DataGridTextColumn Header="CsvlkPid" Binding="{Binding CsvlkPid}" />
                        <DataGridTextColumn Header="CsvlkSkuId" Binding="{Binding CsvlkSkuId}" />
                        <DataGridTextColumn Header="ActivationId" Binding="{Binding ActivationId}" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="VM Activation">
                <DataGrid ItemsSource="{Binding Summary.VmActivation, Converter={StaticResource SingleItemConverter}}" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="InheritedActivationId" Binding="{Binding InheritedActivationId}" />
                        <DataGridTextColumn Header="HostMachineName" Binding="{Binding HostMachineName}" />
                        <DataGridTextColumn Header="HostDigitalPid2" Binding="{Binding HostDigitalPid2}" />
                        <DataGridTextColumn Header="ActivationTime" Binding="{Binding ActivationTime}" />
                        <DataGridTextColumn Header="HostMachineID" Binding="{Binding HostMachineID}" />
                        <DataGridTextColumn Header="HostMachineVersion" Binding="{Binding HostMachineVersion}" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
        </TabControl>
    </DockPanel>
</Window>
